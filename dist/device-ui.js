/// Copyright 2014-2015 Red Hat, Inc. and/or its affiliates
/// and other contributors as indicated by the @author tags.
///
/// Licensed under the Apache License, Version 2.0 (the "License");
/// you may not use this file except in compliance with the License.
/// You may obtain a copy of the License at
///
///   http://www.apache.org/licenses/LICENSE-2.0
///
/// Unless required by applicable law or agreed to in writing, software
/// distributed under the License is distributed on an "AS IS" BASIS,
/// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
/// See the License for the specific language governing permissions and
/// limitations under the License.


var Device;
(function (Device) {
    Device.windowLocationHref = function () {
        return window.location.href;
    };
    Device.windowLocationHostname = function () {
        return window.location.hostname;
    };
    function uriParam(name) {
        var url = Device.windowLocationHref();
        name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
        var results = regex.exec(url);
        return results == null ? null : results[1];
    }
    Device.uriParam = uriParam;
    Device.cloudUriParam = 'cloudUri';
    function cloudletApiBase() {
        var cloudUriFromParam = uriParam(Device.cloudUriParam);
        var uri = cloudUriFromParam == null ? Device.windowLocationHostname() : cloudUriFromParam;
        return 'http://' + uri + ':15000';
    }
    Device.cloudletApiBase = cloudletApiBase;
    function geofencingCloudletApiBase() {
        return cloudletApiBase() + '/geofencing';
    }
    Device.geofencingCloudletApiBase = geofencingCloudletApiBase;
    function deviceCloudletApiBase() {
        return cloudletApiBase();
    }
    Device.deviceCloudletApiBase = deviceCloudletApiBase;
    function deviceManagementCloudletFailure(scope) {
        scope.flash = 'Cannot connect to the Device Management Cloudlet.';
        scope.isDeviceManagementCloudletConnected = false;
    }
    Device.deviceManagementCloudletFailure = deviceManagementCloudletFailure;
})(Device || (Device = {}));

var Devices;
(function (Devices) {
    Devices.pluginName = "cloudlet-device";
    Devices.log = Logger.get(Devices.pluginName);
    Devices.templatePath = "plugins/device/html";
})(Devices || (Devices = {}));

var Devices;
(function (Devices) {
    Devices._module = angular.module(Devices.pluginName, ['ngResource']);
    var tab = undefined;
    Devices._module.config(["$locationProvider", "$routeProvider", "HawtioNavBuilderProvider", function ($locationProvider, $routeProvider, builder) {
        tab = builder.create().id(Devices.pluginName).title(function () { return "Devices"; }).href(function () { return "/devices"; }).subPath("Devices", "devices", builder.join(Devices.templatePath, "devices.html")).build();
        builder.configureRouting($routeProvider, tab);
        $locationProvider.html5Mode(true);
    }]);
    Devices._module.run(["HawtioNav", function (HawtioNav) {
        HawtioNav.add(tab);
        Devices.log.debug("loaded");
    }]);
    hawtioPluginLoader.addModule(Devices.pluginName);
})(Devices || (Devices = {}));

var Devices;
(function (Devices) {
    Devices.RoutesController = Devices._module.controller("Devices.RoutesController", ["$scope", "$http", "$route", "$interval", "$resource", function ($scope, $http, $route, $interval, $resource) {
        $scope.imagesPrefix = window.location.port === '2772' ? 'images' : 'libs/cloudlet-device/images';
        $scope.updateDevicesList = function () {
            $http.get(Device.deviceCloudletApiBase() + '/device/disconnected').success(function (data, status, headers, config) {
                $scope.disconnectedDevices = data.disconnectedDevices;
                $http.get(Device.deviceCloudletApiBase() + '/device').success(function (data, status, headers, config) {
                    $scope.isDeviceManagementCloudletConnected = true;
                    $scope.devices = data.devices;
                }).error(function (data, status, headers, config) {
                    Device.deviceManagementCloudletFailure($scope);
                });
            }).error(function (data, status, headers, config) {
                Device.deviceManagementCloudletFailure($scope);
            });
        };
        $scope.updateDevicesList();
        $interval($scope.updateDevicesList, 5000);
        $scope.sendHeartbeat = function (deviceId) {
            $http.get(Device.deviceCloudletApiBase() + '/device/' + deviceId + '/heartbeat').success(function (data, status, headers, config) {
                Devices.log.debug('Heartbeat sent to the device ' + deviceId + '.');
                $scope.updateDevicesList();
            }).error(function (data, status, headers, config) {
                Device.deviceManagementCloudletFailure($scope);
            });
        };
        $scope.deregister = function (deviceId) {
            $http.delete(Device.deviceCloudletApiBase() + '/device/' + deviceId).success(function (data, status, headers, config) {
                Devices.log.debug('Device ' + deviceId + ' deregistered.');
                $scope.updateDevicesList();
            }).error(function (data, status, headers, config) {
                Device.deviceManagementCloudletFailure($scope);
            });
        };
        $scope.createVirtualDevice = function (deviceId) {
            var DeviceResource = $resource(Device.deviceCloudletApiBase() + '/device');
            var virtualDevice = new DeviceResource({ clientId: deviceId });
            virtualDevice.$save(function (device) {
                Devices.log.debug('New virtual device ' + deviceId + ' has been created.');
                $scope.newDeviceId = '';
                $scope.updateDevicesList();
            }, function (error) {
                Device.deviceManagementCloudletFailure($scope);
            });
        };
        $scope.refreshDeviceDetails = function (deviceId) {
            $scope.deviceDetails = null;
            $scope.deviceEndpoint = deviceId + ' (loading...)';
            $http.get(Device.deviceCloudletApiBase() + '/device/' + deviceId + '/details').success(function (data, status, headers, config) {
                $scope.deviceEndpoint = deviceId;
                var metricIndex;
                var x = [];
                for (metricIndex in Object.keys(data.deviceDetails)) {
                    var metric = Object.keys(data.deviceDetails)[metricIndex];
                    x[metricIndex] = { metric: metric, value: data.deviceDetails[metric] };
                }
                $scope.deviceDetails = x;
            }).error(function (data, status, headers, config) {
                Device.deviceManagementCloudletFailure($scope);
            });
        };
        $scope.deviceDetailsGridOptions = {
            data: 'deviceDetails',
            showSelectionCheckbox: false,
            sortInfo: {
                sortBy: 'metric',
                ascending: true
            },
            columnDefs: [
                {
                    field: 'metric',
                    displayName: 'Device metric'
                },
                {
                    field: 'value',
                    displayName: 'Metric value'
                }
            ]
        };
    }]);
})(Devices || (Devices = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluY2x1ZGVzLmpzIiwiZGV2aWNlL3RzL2RldmljZS50cyIsImRldmljZS90cy9leGFtcGxlR2xvYmFscy50cyIsImRldmljZS90cy9kZXZpY2VzUGx1Z2luLnRzIiwiZGV2aWNlL3RzL2RldmljZXMudHMiXSwibmFtZXMiOlsiRGV2aWNlIiwiRGV2aWNlLnVyaVBhcmFtIiwiRGV2aWNlLmNsb3VkbGV0QXBpQmFzZSIsIkRldmljZS5nZW9mZW5jaW5nQ2xvdWRsZXRBcGlCYXNlIiwiRGV2aWNlLmRldmljZUNsb3VkbGV0QXBpQmFzZSIsIkRldmljZS5kZXZpY2VNYW5hZ2VtZW50Q2xvdWRsZXRGYWlsdXJlIiwiRGV2aWNlcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQ2NBLElBQU8sTUFBTSxDQXVDWjtBQXZDRCxXQUFPLE1BQU0sRUFBQyxDQUFDO0lBRUFBLHlCQUFrQkEsR0FBR0E7UUFDNUIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO0lBQ2hDLENBQUMsQ0FBQ0E7SUFFU0EsNkJBQXNCQSxHQUFHQTtRQUNoQyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7SUFDcEMsQ0FBQyxDQUFDQTtJQUVGQSxTQUFnQkEsUUFBUUEsQ0FBQ0EsSUFBSUE7UUFDekJDLElBQUlBLEdBQUdBLEdBQUdBLE1BQU1BLENBQUNBLGtCQUFrQkEsRUFBRUEsQ0FBQ0E7UUFDdENBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLEVBQUNBLE1BQU1BLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLEVBQUNBLE1BQU1BLENBQUNBLENBQUNBO1FBQzFEQSxJQUFJQSxLQUFLQSxHQUFHQSxJQUFJQSxNQUFNQSxDQUFFQSxRQUFRQSxHQUFDQSxJQUFJQSxHQUFDQSxXQUFXQSxDQUFFQSxDQUFDQTtRQUNwREEsSUFBSUEsT0FBT0EsR0FBR0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBRUEsR0FBR0Es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QUNKLENBQUM7UUFDTixDQUFDLENBQUNBO1FBRUZBLE1BQU1BLENBQUNBLHdCQUF3QkEsR0FBR0E7WUFDOUJBLElBQUlBLEVBQUVBLGVBQWVBO1lBQ3JCQSxxQkFBcUJBLEVBQUVBLEtBQUtBO1lBQzVCQSxRQUFRQSxFQUFFQTtnQkFDTkEsTUFBTUEsRUFBRUEsUUFBUUE7Z0JBQ2hCQSxTQUFTQSxFQUFFQSxJQUFJQTthQUNsQkE7WUFDREEsVUFBVUEsRUFBRUE7Z0JBQ1JBO29CQUNJQSxLQUFLQSxFQUFFQSxRQUFRQTtvQkFDZkEsV0FBV0EsRUFBRUEsZUFBZUE7aUJBQy9CQTtnQkFDREE7b0JBQ0lBLEtBQUtBLEVBQUVBLE9BQU9BO29CQUNkQSxXQUFXQSxFQUFFQSxjQUFjQTtpQkFDOUJBO2FBQ0pBO1NBQ0pBLENBQUNBO0lBQ05BLENBQUNBLENBQUNBLENBQUNBLENBQUNBO0FBRU5BLENBQUNBLEVBMUdNLE9BQU8sS0FBUCxPQUFPLFFBMEdiIiwiZmlsZSI6ImNvbXBpbGVkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIENvcHlyaWdodCAyMDE0LTIwMTUgUmVkIEhhdCwgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXNcbi8vLyBhbmQgb3RoZXIgY29udHJpYnV0b3JzIGFzIGluZGljYXRlZCBieSB0aGUgQGF1dGhvciB0YWdzLlxuLy8vXG4vLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vLy9cbi8vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy8vXG4vLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vbGlicy9oYXd0aW8tdXRpbGl0aWVzL2RlZnMuZC50c1wiLz5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluY2x1ZGVzLmpzLm1hcCIsIi8vLyBDb3B5cmlnaHQgMjAxNC0yMDE1IFJlZCBIYXQsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzXG4vLy8gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQgYnkgdGhlIEBhdXRob3IgdGFncy5cbi8vL1xuLy8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy8vXG4vLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vL1xuLy8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG5tb2R1bGUgRGV2aWNlIHtcblxuICAgIGV4cG9ydCB2YXIgd2luZG93TG9jYXRpb25IcmVmID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICB9O1xuXG4gICAgZXhwb3J0IHZhciB3aW5kb3dMb2NhdGlvbkhvc3RuYW1lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7XG4gICAgfTtcblxuICAgIGV4cG9ydCBmdW5jdGlvbiB1cmlQYXJhbShuYW1lKSB7XG4gICAgICAgIHZhciB1cmwgPSBEZXZpY2Uud2luZG93TG9jYXRpb25IcmVmKCk7XG4gICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtdLyxcIlxcXFxcXFtcIikucmVwbGFjZSgvW1xcXV0vLFwiXFxcXFxcXVwiKTtcbiAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCggXCJbXFxcXD8mXVwiK25hbWUrXCI9KFteJiNdKilcIiApO1xuICAgICAgICB2YXIgcmVzdWx0cyA9IHJlZ2V4LmV4ZWMoIHVybCApO1xuICAgICAgICByZXR1cm4gcmVzdWx0cyA9PSBudWxsID8gbnVsbCA6IHJlc3VsdHNbMV07XG4gICAgfVxuXG4gICAgZXhwb3J0IHZhciBjbG91ZFVyaVBhcmFtID0gJ2Nsb3VkVXJpJztcblxuICAgIGV4cG9ydCBmdW5jdGlvbiBjbG91ZGxldEFwaUJhc2UoKSB7XG4gICAgICAgIHZhciBjbG91ZFVyaUZyb21QYXJhbSA9IHVyaVBhcmFtKGNsb3VkVXJpUGFyYW0pO1xuICAgICAgICB2YXIgdXJpID0gY2xvdWRVcmlGcm9tUGFyYW0gPT0gbnVsbCA/IHdpbmRvd0xvY2F0aW9uSG9zdG5hbWUoKSA6IGNsb3VkVXJpRnJvbVBhcmFtO1xuICAgICAgICByZXR1cm4gJ2h0dHA6Ly8nICsgdXJpICsgJzoxNTAwMCc7XG4gICAgfVxuXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGdlb2ZlbmNpbmdDbG91ZGxldEFwaUJhc2UoKSB7XG4gICAgICAgIHJldHVybiBjbG91ZGxldEFwaUJhc2UoKSArICcvZ2VvZmVuY2luZyc7XG4gICAgfVxuXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGRldmljZUNsb3VkbGV0QXBpQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIGNsb3VkbGV0QXBpQmFzZSgpO1xuICAgIH1cblxuICAgIGV4cG9ydCBmdW5jdGlvbiBkZXZpY2VNYW5hZ2VtZW50Q2xvdWRsZXRGYWlsdXJlKHNjb3BlKSB7XG4gICAgICAgIHNjb3BlLmZsYXNoID0gJ0Nhbm5vdCBjb25uZWN0IHRvIHRoZSBEZXZpY2UgTWFuYWdlbWVudCBDbG91ZGxldC4nO1xuICAgICAgICBzY29wZS5pc0RldmljZU1hbmFnZW1lbnRDbG91ZGxldENvbm5lY3RlZCA9IGZhbHNlO1xuICAgIH1cblxufVxuIiwiLy8vIENvcHlyaWdodCAyMDE0LTIwMTUgUmVkIEhhdCwgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXNcbi8vLyBhbmQgb3RoZXIgY29udHJpYnV0b3JzIGFzIGluZGljYXRlZCBieSB0aGUgQGF1dGhvciB0YWdzLlxuLy8vXG4vLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vLy9cbi8vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy8vXG4vLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9pbmNsdWRlcy50c1wiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJkZXZpY2UudHNcIi8+XG5tb2R1bGUgRGV2aWNlcyB7XG5cbiAgZXhwb3J0IHZhciBwbHVnaW5OYW1lID0gXCJjbG91ZGxldC1kZXZpY2VcIjtcblxuICBleHBvcnQgdmFyIGxvZzogTG9nZ2luZy5Mb2dnZXIgPSBMb2dnZXIuZ2V0KHBsdWdpbk5hbWUpO1xuXG4gIGV4cG9ydCB2YXIgdGVtcGxhdGVQYXRoID0gXCJwbHVnaW5zL2RldmljZS9odG1sXCI7XG5cbn1cbiIsIi8vLyBDb3B5cmlnaHQgMjAxNC0yMDE1IFJlZCBIYXQsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzXG4vLy8gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQgYnkgdGhlIEBhdXRob3IgdGFncy5cbi8vL1xuLy8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy8vXG4vLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vL1xuLy8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vaW5jbHVkZXMudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiZXhhbXBsZUdsb2JhbHMudHNcIi8+XG5tb2R1bGUgRGV2aWNlcyB7XG5cbiAgZXhwb3J0IHZhciBfbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoRGV2aWNlcy5wbHVnaW5OYW1lLCBbJ25nUmVzb3VyY2UnXSk7XG5cbiAgdmFyIHRhYiA9IHVuZGVmaW5lZDtcblxuICBfbW9kdWxlLmNvbmZpZyhbXCIkbG9jYXRpb25Qcm92aWRlclwiLCBcIiRyb3V0ZVByb3ZpZGVyXCIsIFwiSGF3dGlvTmF2QnVpbGRlclByb3ZpZGVyXCIsXG4gICAgKCRsb2NhdGlvblByb3ZpZGVyLCAkcm91dGVQcm92aWRlcjogbmcucm91dGUuSVJvdXRlUHJvdmlkZXIsIGJ1aWxkZXI6IEhhd3Rpb01haW5OYXYuQnVpbGRlckZhY3RvcnkpID0+IHtcbiAgICB0YWIgPSBidWlsZGVyLmNyZWF0ZSgpXG4gICAgICAuaWQoRGV2aWNlcy5wbHVnaW5OYW1lKVxuICAgICAgLnRpdGxlKCgpID0+IFwiRGV2aWNlc1wiKVxuICAgICAgLmhyZWYoKCkgPT4gXCIvZGV2aWNlc1wiKVxuICAgICAgLnN1YlBhdGgoXCJEZXZpY2VzXCIsIFwiZGV2aWNlc1wiLCBidWlsZGVyLmpvaW4oRGV2aWNlcy50ZW1wbGF0ZVBhdGgsIFwiZGV2aWNlcy5odG1sXCIpKVxuICAgICAgLmJ1aWxkKCk7XG4gICAgYnVpbGRlci5jb25maWd1cmVSb3V0aW5nKCRyb3V0ZVByb3ZpZGVyLCB0YWIpO1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbiAgfV0pO1xuXG4gIF9tb2R1bGUucnVuKFtcIkhhd3Rpb05hdlwiLCAoSGF3dGlvTmF2OiBIYXd0aW9NYWluTmF2LlJlZ2lzdHJ5KSA9PiB7XG4gICAgSGF3dGlvTmF2LmFkZCh0YWIpO1xuICAgIGxvZy5kZWJ1ZyhcImxvYWRlZFwiKTtcbiAgfV0pO1xuXG5cbiAgaGF3dGlvUGx1Z2luTG9hZGVyLmFkZE1vZHVsZShEZXZpY2VzLnBsdWdpbk5hbWUpO1xufVxuIiwiLy8vIENvcHlyaWdodCAyMDE0LTIwMTUgUmVkIEhhdCwgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXNcbi8vLyBhbmQgb3RoZXIgY29udHJpYnV0b3JzIGFzIGluZGljYXRlZCBieSB0aGUgQGF1dGhvciB0YWdzLlxuLy8vXG4vLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vLy9cbi8vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy8vXG4vLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJkZXZpY2VzUGx1Z2luLnRzXCIvPlxubW9kdWxlIERldmljZXMge1xuXG4gIGV4cG9ydCB2YXIgUm91dGVzQ29udHJvbGxlciA9IF9tb2R1bGUuY29udHJvbGxlcihcIkRldmljZXMuUm91dGVzQ29udHJvbGxlclwiLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCBcIiRyb3V0ZVwiLCBcIiRpbnRlcnZhbFwiLCBcIiRyZXNvdXJjZVwiLCAoJHNjb3BlLCAkaHR0cCwgJHJvdXRlLCAkaW50ZXJ2YWwsICRyZXNvdXJjZSkgPT4ge1xuICAgICAgJHNjb3BlLmltYWdlc1ByZWZpeCA9IHdpbmRvdy5sb2NhdGlvbi5wb3J0ID09PSAnMjc3MicgPyAnaW1hZ2VzJyA6ICdsaWJzL2Nsb3VkbGV0LWRldmljZS9pbWFnZXMnO1xuXG4gICAgICAkc2NvcGUudXBkYXRlRGV2aWNlc0xpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkaHR0cC5nZXQoRGV2aWNlLmRldmljZUNsb3VkbGV0QXBpQmFzZSgpICsgJy9kZXZpY2UvZGlzY29ubmVjdGVkJykuXG4gICAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICRzY29wZS5kaXNjb25uZWN0ZWREZXZpY2VzID0gZGF0YS5kaXNjb25uZWN0ZWREZXZpY2VzO1xuICAgICAgICAgICAgICAgICAgJGh0dHAuZ2V0KERldmljZS5kZXZpY2VDbG91ZGxldEFwaUJhc2UoKSArICcvZGV2aWNlJykuXG4gICAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNEZXZpY2VNYW5hZ2VtZW50Q2xvdWRsZXRDb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGV2aWNlcyA9IGRhdGEuZGV2aWNlcztcbiAgICAgICAgICAgICAgICAgICAgICB9KS5cbiAgICAgICAgICAgICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBEZXZpY2UuZGV2aWNlTWFuYWdlbWVudENsb3VkbGV0RmFpbHVyZSgkc2NvcGUpO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9KS5cbiAgICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgIERldmljZS5kZXZpY2VNYW5hZ2VtZW50Q2xvdWRsZXRGYWlsdXJlKCRzY29wZSk7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICB9O1xuXG4gICAgICAkc2NvcGUudXBkYXRlRGV2aWNlc0xpc3QoKTtcbiAgICAgICRpbnRlcnZhbCgkc2NvcGUudXBkYXRlRGV2aWNlc0xpc3QsIDUwMDApO1xuXG4gICAgICAkc2NvcGUuc2VuZEhlYXJ0YmVhdCA9IGZ1bmN0aW9uKGRldmljZUlkKSB7XG4gICAgICAgICAgJGh0dHAuZ2V0KERldmljZS5kZXZpY2VDbG91ZGxldEFwaUJhc2UoKSArICcvZGV2aWNlLycgKyBkZXZpY2VJZCArICcvaGVhcnRiZWF0JykuXG4gICAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgIGxvZy5kZWJ1ZygnSGVhcnRiZWF0IHNlbnQgdG8gdGhlIGRldmljZSAnICsgZGV2aWNlSWQgKyAnLicpO1xuICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZURldmljZXNMaXN0KCk7XG4gICAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgRGV2aWNlLmRldmljZU1hbmFnZW1lbnRDbG91ZGxldEZhaWx1cmUoJHNjb3BlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICAkc2NvcGUuZGVyZWdpc3RlciA9IGZ1bmN0aW9uKGRldmljZUlkKSB7XG4gICAgICAgICAgJGh0dHAuZGVsZXRlKERldmljZS5kZXZpY2VDbG91ZGxldEFwaUJhc2UoKSArICcvZGV2aWNlLycgKyBkZXZpY2VJZCkuXG4gICAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgIGxvZy5kZWJ1ZygnRGV2aWNlICcgKyBkZXZpY2VJZCArICcgZGVyZWdpc3RlcmVkLicpO1xuICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZURldmljZXNMaXN0KCk7XG4gICAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgRGV2aWNlLmRldmljZU1hbmFnZW1lbnRDbG91ZGxldEZhaWx1cmUoJHNjb3BlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICAkc2NvcGUuY3JlYXRlVmlydHVhbERldmljZSA9IGZ1bmN0aW9uKGRldmljZUlkKSB7XG4gICAgICAgICAgdmFyIERldmljZVJlc291cmNlID0gJHJlc291cmNlKERldmljZS5kZXZpY2VDbG91ZGxldEFwaUJhc2UoKSArICcvZGV2aWNlJyk7XG4gICAgICAgICAgdmFyIHZpcnR1YWxEZXZpY2UgPSBuZXcgRGV2aWNlUmVzb3VyY2Uoe2NsaWVudElkOiBkZXZpY2VJZH0pO1xuICAgICAgICAgIHZpcnR1YWxEZXZpY2UuJHNhdmUoXG4gICAgICAgICAgICAgIGZ1bmN0aW9uKGRldmljZSkge1xuICAgICAgICAgICAgICAgICAgbG9nLmRlYnVnKCdOZXcgdmlydHVhbCBkZXZpY2UgJyArIGRldmljZUlkICsgJyBoYXMgYmVlbiBjcmVhdGVkLicpO1xuICAgICAgICAgICAgICAgICAgJHNjb3BlLm5ld0RldmljZUlkID0gJyc7XG4gICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlRGV2aWNlc0xpc3QoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgICAgICAgIERldmljZS5kZXZpY2VNYW5hZ2VtZW50Q2xvdWRsZXRGYWlsdXJlKCRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgIH07XG5cbiAgICAgICRzY29wZS5yZWZyZXNoRGV2aWNlRGV0YWlscyA9IGZ1bmN0aW9uKGRldmljZUlkKSB7XG4gICAgICAgICAgJHNjb3BlLmRldmljZURldGFpbHMgPSBudWxsO1xuICAgICAgICAgICRzY29wZS5kZXZpY2VFbmRwb2ludCA9IGRldmljZUlkICsgJyAobG9hZGluZy4uLiknO1xuICAgICAgICAgICRodHRwLmdldChEZXZpY2UuZGV2aWNlQ2xvdWRsZXRBcGlCYXNlKCkgKyAnL2RldmljZS8nICsgZGV2aWNlSWQgKyAnL2RldGFpbHMnKS5cbiAgICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICRzY29wZS5kZXZpY2VFbmRwb2ludCA9IGRldmljZUlkO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgbWV0cmljSW5kZXg7XG4gICAgICAgICAgICAgICAgICB2YXIgeCA9IFtdO1xuICAgICAgICAgICAgICAgICAgZm9yIChtZXRyaWNJbmRleCBpbiBPYmplY3Qua2V5cyhkYXRhLmRldmljZURldGFpbHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIG1ldHJpYyA9IE9iamVjdC5rZXlzKGRhdGEuZGV2aWNlRGV0YWlscylbbWV0cmljSW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgIHhbbWV0cmljSW5kZXhdID0ge21ldHJpYzogbWV0cmljLCB2YWx1ZTogZGF0YS5kZXZpY2VEZXRhaWxzW21ldHJpY119O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmRldmljZURldGFpbHMgPSB4O1xuICAgICAgICAgICAgICB9KS5cbiAgICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICBEZXZpY2UuZGV2aWNlTWFuYWdlbWVudENsb3VkbGV0RmFpbHVyZSgkc2NvcGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgIH07XG5cbiAgICAgICRzY29wZS5kZXZpY2VEZXRhaWxzR3JpZE9wdGlvbnMgPSB7XG4gICAgICAgICAgZGF0YTogJ2RldmljZURldGFpbHMnLFxuICAgICAgICAgIHNob3dTZWxlY3Rpb25DaGVja2JveDogZmFsc2UsXG4gICAgICAgICAgc29ydEluZm86IHtcbiAgICAgICAgICAgICAgc29ydEJ5OiAnbWV0cmljJyxcbiAgICAgICAgICAgICAgYXNjZW5kaW5nOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjb2x1bW5EZWZzOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGZpZWxkOiAnbWV0cmljJyxcbiAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRGV2aWNlIG1ldHJpYydcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgZmllbGQ6ICd2YWx1ZScsXG4gICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ01ldHJpYyB2YWx1ZSdcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgIH07XG4gIH1dKTtcblxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
angular.module("device-ui-templates", []).run(["$templateCache", function($templateCache) {$templateCache.put("plugins/device/html/devices.html","<!--\n Licensed to the Camel Labs under one or more\n contributor license agreements.  See the NOTICE file distributed with\n this work for additional information regarding copyright ownership.\n The licenses this file to You under the Apache License, Version 2.0\n (the \"License\"); you may not use this file except in compliance with\n the License.  You may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n-->\n<div class=\"row\">\n    <div class=\"col-md-12\" ng-controller=\"Devices.RoutesController\">\n        <p ng-show=\"flash\"><i class=\"fa fa-info-circle\"> {{flash}}</i></p>\n\n        <div ng-show=\"isDeviceManagementCloudletConnected\">\n\n        <h2>Devices registered in the cloud</h2>\n        <p>\n            <table>\n            <tr>\n                <td>\n                    <input type=\"text\" ng-model=\"newDeviceId\" />\n                </td>\n                <td>\n                    <button ng-disabled=\"newDeviceId === nil || newDeviceId.length === 0\" class=\"btn\" ng-click=\"createVirtualDevice(newDeviceId)\">\n                Create virtual device\n            </button>\n                </td>\n            </tr>\n        </table>\n        </p>\n        <p>\n\n            <table ng-show=\"devices.length > 0\">\n                <tr ng-repeat=\"device in devices\">\n                    <td style=\"padding-right: 10px;padding-bottom: 10px;\" ng-click=\"refreshDeviceDetails(device.endpoint)\">\n                        <i ng-show=\"!disconnectedDevices.contains(device.endpoint)\" class=\"fa fa-heart\"> {{device.endpoint}}</i>\n                        <i ng-show=\"disconnectedDevices.contains(device.endpoint)\" class=\"fa fa-heart-o\"> {{device.endpoint}}</i>\n                    </td>\n                    <td style=\"padding-right: 10px;padding-bottom: 10px;\">\n                        <button class=\"btn\" ng-click=\"deregister(device.endpoint)\">\n                            Deregister\n                        </button>\n                    </td>\n                    <td style=\"padding-right: 10px;padding-bottom: 10px;\">\n                        <button class=\"btn\" ng-click=\"sendHeartbeat(device.endpoint)\">\n                            Send heartbeat\n                        </button>\n                    </td>\n                </tr>\n            </table>\n\n            <table ng-show=\"deviceDetails\" class=\"table table-condensed table-striped\" hawtio-simple-table=\"deviceDetailsGridOptions\">\n                <b>{{deviceEndpoint}}</b>\n            </table>\n\n            <div ng-show=\"devices.length === 0\">\n                No devices registered in the cloud. Use our\n                <a href=\"https://github.com/rhiot/rhiot/blob/master/docs/readme.md#device-management-rest-api\">REST</a>\n                or <a href=\"https://github.com/rhiot/rhiot/blob/master/docs/readme.md#accessing-lwm2m-server-directly\">LWM2M</a>\n                APIs to connect your devices.\n                <br>\n                You can also create the virtual device using the form above - just give it\n                the unique name!\n            </div>\n        </p>\n        </div>\n    </div>\n</div>\n");}]); hawtioPluginLoader.addModule("device-ui-templates");