/// Copyright 2014-2015 Red Hat, Inc. and/or its affiliates
/// and other contributors as indicated by the @author tags.
///
/// Licensed under the Apache License, Version 2.0 (the "License");
/// you may not use this file except in compliance with the License.
/// You may obtain a copy of the License at
///
///   http://www.apache.org/licenses/LICENSE-2.0
///
/// Unless required by applicable law or agreed to in writing, software
/// distributed under the License is distributed on an "AS IS" BASIS,
/// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
/// See the License for the specific language governing permissions and
/// limitations under the License.


var Geofencing;
(function (Geofencing) {
    Geofencing.windowLocationHref = function () {
        return window.location.href;
    };
    Geofencing.windowLocationHostname = function () {
        return window.location.hostname;
    };
    function uriParam(name) {
        var url = Geofencing.windowLocationHref();
        name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
        var results = regex.exec(url);
        return results == null ? null : results[1];
    }
    Geofencing.uriParam = uriParam;
    Geofencing.cloudUriParam = 'cloudUri';
    function cloudletApiBase() {
        var cloudUriFromParam = uriParam(Geofencing.cloudUriParam);
        var uri = cloudUriFromParam == null ? Geofencing.windowLocationHostname() : cloudUriFromParam;
        return 'http://' + uri + ':15000/api';
    }
    Geofencing.cloudletApiBase = cloudletApiBase;
    function geofencingCloudletApiBase() {
        return cloudletApiBase() + '/geofencing';
    }
    Geofencing.geofencingCloudletApiBase = geofencingCloudletApiBase;
    function documentCloudletApiBase() {
        return cloudletApiBase() + '/document';
    }
    Geofencing.documentCloudletApiBase = documentCloudletApiBase;
    function deviceCloudletApiBase() {
        return cloudletApiBase();
    }
    Geofencing.deviceCloudletApiBase = deviceCloudletApiBase;
})(Geofencing || (Geofencing = {}));

var Devices;
(function (Devices) {
    Devices.pluginName = "cloudlet-device";
    Devices.log = Logger.get(Devices.pluginName);
    Devices.templatePath = "plugins/example/html";
})(Devices || (Devices = {}));

var Devices;
(function (Devices) {
    Devices._module = angular.module(Devices.pluginName, []);
    var tab = undefined;
    Devices._module.config(["$locationProvider", "$routeProvider", "HawtioNavBuilderProvider", function ($locationProvider, $routeProvider, builder) {
        tab = builder.create().id(Devices.pluginName).title(function () { return "Devices"; }).href(function () { return "/devices"; }).subPath("Devices", "devices", builder.join(Devices.templatePath, "devices.html")).build();
        builder.configureRouting($routeProvider, tab);
        $locationProvider.html5Mode(true);
    }]);
    Devices._module.run(["HawtioNav", function (HawtioNav) {
        HawtioNav.add(tab);
        Devices.log.debug("loaded");
    }]);
    hawtioPluginLoader.addModule(Devices.pluginName);
})(Devices || (Devices = {}));

var Devices;
(function (Devices) {
    Devices.RoutesController = Devices._module.controller("Devices.RoutesController", ["$scope", "$http", "$route", function ($scope, $http, $route) {
        $http.get(Geofencing.deviceCloudletApiBase() + '/device').success(function (data, status, headers, config) {
            $scope.devices = data.devices;
        }).error(function (data, status, headers, config) {
            $scope.flash = 'Cannot connect to the device service.';
        });
        $scope.loadRoutes = function () {
            $http.get(Geofencing.geofencingCloudletApiBase() + '/routes/routes/' + $scope.selectedOption.id).success(function (data, status, headers, config) {
                $scope.routes = data.routes.map(function (val) {
                    var routeTimestamp = new Date(val.created);
                    var timestamp = (routeTimestamp.getMonth() + 1) + "-" + routeTimestamp.getDate() + "-" + routeTimestamp.getFullYear() + ' ' + routeTimestamp.getHours() + ":" + routeTimestamp.getMinutes() + ":" + routeTimestamp.getSeconds();
                    return {
                        name: timestamp,
                        id: val.id
                    };
                });
                if (data.routes.length > 0) {
                    $scope.selectedRoute = $scope.routes[0];
                    $scope.routeSelected();
                }
            }).error(function (data, status, headers, config) {
                $scope.flash = 'Cannot connect to the geofencing service.';
            });
        };
        $scope.clientSelected = function () {
            $scope.client = $scope.selectedOption.id;
            $scope.routesExportLink = Geofencing.geofencingCloudletApiBase() + '/routes/export/' + $scope.client + '/xls';
            $scope.loadRoutes();
        };
        $scope.routeSelected = function () {
            $http.get(Geofencing.geofencingCloudletApiBase() + '/routes/routeUrl/' + $scope.selectedRoute.id).success(function (data, status, headers, config) {
                $scope.routeUrl = data.routeUrl;
                $scope.loadRouteComments();
            }).error(function (data, status, headers, config) {
                $scope.flash = 'Cannot connect to the geofencing service.';
            });
        };
        $http.get(Geofencing.geofencingCloudletApiBase() + '/routes/clients').success(function (data, status, headers, config) {
            $scope.clients = data.clients.map(function (val) {
                return {
                    name: val,
                    id: val
                };
            });
            if (data.clients.length > 0) {
                $scope.selectedOption = $scope.clients[0];
                $scope.clientSelected();
            }
        }).error(function (data, status, headers, config) {
            $scope.flash = 'Cannot connect to the geofencing service.';
        });
        $scope.addComment = function () {
            $http.post(Geofencing.cloudletApiBase() + '/document/save/RouteComment', { routeId: $scope.selectedRoute.id, text: $scope.newComment, created: new Date().getTime() }).success(function (data, status, headers, config) {
                $scope.loadRouteComments();
                $scope.flash = 'New comment has been added to the route.';
            }).error(function (data, status, headers, config) {
                $scope.flash = 'There was problem with adding comment to the route.';
            });
        };
        $scope.loadRouteComments = function () {
            $http.post(Geofencing.cloudletApiBase() + '/document/findByQuery/RouteComment', { page: 0, size: 100, orderBy: ['created'], sortAscending: -1, query: { routeIdIn: [$scope.selectedRoute.id] } }).success(function (data, status, headers, config) {
                $scope.routeComments = data;
            }).error(function (data, status, headers, config) {
                $scope.flash = 'There was problem reading route comments.';
            });
        };
        $scope.deleteRoute = function () {
            $http.delete(Geofencing.geofencingCloudletApiBase() + '/routes/delete/' + $scope.selectedRoute.id);
            $route.reload();
        };
    }]);
})(Devices || (Devices = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluY2x1ZGVzLmpzIiwiZXhhbXBsZS90cy9nZW9mZW5jaW5nLnRzIiwiZXhhbXBsZS90cy9leGFtcGxlR2xvYmFscy50cyIsImV4YW1wbGUvdHMvZXhhbXBsZVBsdWdpbi50cyIsImV4YW1wbGUvdHMvcm91dGVzLnRzIl0sIm5hbWVzIjpbIkdlb2ZlbmNpbmciLCJHZW9mZW5jaW5nLnVyaVBhcmFtIiwiR2VvZmVuY2luZy5jbG91ZGxldEFwaUJhc2UiLCJHZW9mZW5jaW5nLmdlb2ZlbmNpbmdDbG91ZGxldEFwaUJhc2UiLCJHZW9mZW5jaW5nLmRvY3VtZW50Q2xvdWRsZXRBcGlCYXNlIiwiR2VvZmVuY2luZy5kZXZpY2VDbG91ZGxldEFwaUJhc2UiLCJEZXZpY2VzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FDY0EsSUFBTyxVQUFVLENBc0NoQjtBQXRDRCxXQUFPLFVBQVUsRUFBQyxDQUFDO0lBRUpBLDZCQUFrQkEsR0FBR0E7UUFDNUIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO0lBQ2hDLENBQUMsQ0FBQ0E7SUFFU0EsaUNBQXNCQSxHQUFHQTtRQUNoQyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7SUFDcEMsQ0FBQyxDQUFDQTtJQUVGQSxTQUFnQkEsUUFBUUEsQ0FBQ0EsSUFBSUE7UUFDekJDLElBQUlBLEdBQUdBLEdBQUdBLFVBQVVBLENBQUNBLGtCQUFrQkEsRUFBRUEsQ0FBQ0E7UUFDMUNBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLEVBQUNBLE1BQU1BLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLEVBQUNBLE1BQU1BLENBQUNBLENBQUNBO1FBQzFEQSxJQUFJQSxLQUFLQSxHQUFHQSxJQUFJQSxNQUFNQSxDQUFFQSxRQUFRQSxHQUFDQSxJQUFJQSxHQUFDQSxXQUFXQSxDQUFFQSxDQUFDQTtRQUNwREEsSUFBSUEsT0FBT0EsR0FBR0EsS0FBS0Es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QVUsQ0FBQyxlQUFlLEVBQUUsR0FBRyxvQ0FBb0MsRUFBRSxFQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxhQUFhLEVBQUUsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUMsU0FBUyxFQUFFLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFDLENBQUMsQ0FDekwsT0FBTyxDQUFDLFVBQVMsSUFBSSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTTtnQkFDMUMsTUFBTSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7WUFDaEMsQ0FBQyxDQUFDLENBQ0YsS0FBSyxDQUFDLFVBQVMsSUFBSSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTTtnQkFDeEMsTUFBTSxDQUFDLEtBQUssR0FBRywyQ0FBMkMsQ0FBQztZQUMvRCxDQUFDLENBQUMsQ0FBQztRQUNYLENBQUMsQ0FBQ0E7UUFFRkEsTUFBTUEsQ0FBQ0EsV0FBV0EsR0FBR0E7WUFDakIsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMseUJBQXlCLEVBQUUsR0FBRyxpQkFBaUIsR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ25HLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNwQixDQUFDLENBQUNBO0lBQ05BLENBQUNBLENBQUNBLENBQUNBLENBQUNBO0FBRU5BLENBQUNBLEVBekZNLE9BQU8sS0FBUCxPQUFPLFFBeUZiIiwiZmlsZSI6ImNvbXBpbGVkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIENvcHlyaWdodCAyMDE0LTIwMTUgUmVkIEhhdCwgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXNcbi8vLyBhbmQgb3RoZXIgY29udHJpYnV0b3JzIGFzIGluZGljYXRlZCBieSB0aGUgQGF1dGhvciB0YWdzLlxuLy8vXG4vLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vLy9cbi8vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy8vXG4vLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vbGlicy9oYXd0aW8tdXRpbGl0aWVzL2RlZnMuZC50c1wiLz5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluY2x1ZGVzLmpzLm1hcCIsIi8vLyBDb3B5cmlnaHQgMjAxNC0yMDE1IFJlZCBIYXQsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzXG4vLy8gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQgYnkgdGhlIEBhdXRob3IgdGFncy5cbi8vL1xuLy8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy8vXG4vLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vL1xuLy8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG5tb2R1bGUgR2VvZmVuY2luZyB7XG5cbiAgICBleHBvcnQgdmFyIHdpbmRvd0xvY2F0aW9uSHJlZiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgfTtcblxuICAgIGV4cG9ydCB2YXIgd2luZG93TG9jYXRpb25Ib3N0bmFtZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lO1xuICAgIH07XG5cbiAgICBleHBvcnQgZnVuY3Rpb24gdXJpUGFyYW0obmFtZSkge1xuICAgICAgICB2YXIgdXJsID0gR2VvZmVuY2luZy53aW5kb3dMb2NhdGlvbkhyZWYoKTtcbiAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW10vLFwiXFxcXFxcW1wiKS5yZXBsYWNlKC9bXFxdXS8sXCJcXFxcXFxdXCIpO1xuICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKCBcIltcXFxcPyZdXCIrbmFtZStcIj0oW14mI10qKVwiICk7XG4gICAgICAgIHZhciByZXN1bHRzID0gcmVnZXguZXhlYyggdXJsICk7XG4gICAgICAgIHJldHVybiByZXN1bHRzID09IG51bGwgPyBudWxsIDogcmVzdWx0c1sxXTtcbiAgICB9XG5cbiAgICBleHBvcnQgdmFyIGNsb3VkVXJpUGFyYW0gPSAnY2xvdWRVcmknO1xuXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGNsb3VkbGV0QXBpQmFzZSgpIHtcbiAgICAgICAgdmFyIGNsb3VkVXJpRnJvbVBhcmFtID0gdXJpUGFyYW0oY2xvdWRVcmlQYXJhbSk7XG4gICAgICAgIHZhciB1cmkgPSBjbG91ZFVyaUZyb21QYXJhbSA9PSBudWxsID8gd2luZG93TG9jYXRpb25Ib3N0bmFtZSgpIDogY2xvdWRVcmlGcm9tUGFyYW07XG4gICAgICAgIHJldHVybiAnaHR0cDovLycgKyB1cmkgKyAnOjE1MDAwL2FwaSc7XG4gICAgfVxuXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGdlb2ZlbmNpbmdDbG91ZGxldEFwaUJhc2UoKSB7XG4gICAgICAgIHJldHVybiBjbG91ZGxldEFwaUJhc2UoKSArICcvZ2VvZmVuY2luZyc7XG4gICAgfVxuXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGRvY3VtZW50Q2xvdWRsZXRBcGlCYXNlKCkge1xuICAgICAgICByZXR1cm4gY2xvdWRsZXRBcGlCYXNlKCkgKyAnL2RvY3VtZW50JztcbiAgICB9XG5cbiAgICBleHBvcnQgZnVuY3Rpb24gZGV2aWNlQ2xvdWRsZXRBcGlCYXNlKCkge1xuICAgICAgICByZXR1cm4gY2xvdWRsZXRBcGlCYXNlKCk7XG4gICAgfVxuXG59XG4iLCIvLy8gQ29weXJpZ2h0IDIwMTQtMjAxNSBSZWQgSGF0LCBJbmMuIGFuZC9vciBpdHMgYWZmaWxpYXRlc1xuLy8vIGFuZCBvdGhlciBjb250cmlidXRvcnMgYXMgaW5kaWNhdGVkIGJ5IHRoZSBAYXV0aG9yIHRhZ3MuXG4vLy9cbi8vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vL1xuLy8vICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vLy9cbi8vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2luY2x1ZGVzLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImdlb2ZlbmNpbmcudHNcIi8+XG5tb2R1bGUgRGV2aWNlcyB7XG5cbiAgZXhwb3J0IHZhciBwbHVnaW5OYW1lID0gXCJjbG91ZGxldC1kZXZpY2VcIjtcblxuICBleHBvcnQgdmFyIGxvZzogTG9nZ2luZy5Mb2dnZXIgPSBMb2dnZXIuZ2V0KHBsdWdpbk5hbWUpO1xuXG4gIGV4cG9ydCB2YXIgdGVtcGxhdGVQYXRoID0gXCJwbHVnaW5zL2V4YW1wbGUvaHRtbFwiO1xuXG59XG4iLCIvLy8gQ29weXJpZ2h0IDIwMTQtMjAxNSBSZWQgSGF0LCBJbmMuIGFuZC9vciBpdHMgYWZmaWxpYXRlc1xuLy8vIGFuZCBvdGhlciBjb250cmlidXRvcnMgYXMgaW5kaWNhdGVkIGJ5IHRoZSBAYXV0aG9yIHRhZ3MuXG4vLy9cbi8vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vL1xuLy8vICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vLy9cbi8vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2luY2x1ZGVzLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImV4YW1wbGVHbG9iYWxzLnRzXCIvPlxubW9kdWxlIERldmljZXMge1xuXG4gIGV4cG9ydCB2YXIgX21vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKERldmljZXMucGx1Z2luTmFtZSwgW10pO1xuXG4gIHZhciB0YWIgPSB1bmRlZmluZWQ7XG5cbiAgX21vZHVsZS5jb25maWcoW1wiJGxvY2F0aW9uUHJvdmlkZXJcIiwgXCIkcm91dGVQcm92aWRlclwiLCBcIkhhd3Rpb05hdkJ1aWxkZXJQcm92aWRlclwiLFxuICAgICgkbG9jYXRpb25Qcm92aWRlciwgJHJvdXRlUHJvdmlkZXI6IG5nLnJvdXRlLklSb3V0ZVByb3ZpZGVyLCBidWlsZGVyOiBIYXd0aW9NYWluTmF2LkJ1aWxkZXJGYWN0b3J5KSA9PiB7XG4gICAgdGFiID0gYnVpbGRlci5jcmVhdGUoKVxuICAgICAgLmlkKERldmljZXMucGx1Z2luTmFtZSlcbiAgICAgIC50aXRsZSgoKSA9PiBcIkRldmljZXNcIilcbiAgICAgIC5ocmVmKCgpID0+IFwiL2RldmljZXNcIilcbiAgICAgIC5zdWJQYXRoKFwiRGV2aWNlc1wiLCBcImRldmljZXNcIiwgYnVpbGRlci5qb2luKERldmljZXMudGVtcGxhdGVQYXRoLCBcImRldmljZXMuaHRtbFwiKSlcbiAgICAgIC5idWlsZCgpO1xuICAgIGJ1aWxkZXIuY29uZmlndXJlUm91dGluZygkcm91dGVQcm92aWRlciwgdGFiKTtcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gIH1dKTtcblxuICBfbW9kdWxlLnJ1bihbXCJIYXd0aW9OYXZcIiwgKEhhd3Rpb05hdjogSGF3dGlvTWFpbk5hdi5SZWdpc3RyeSkgPT4ge1xuICAgIEhhd3Rpb05hdi5hZGQodGFiKTtcbiAgICBsb2cuZGVidWcoXCJsb2FkZWRcIik7XG4gIH1dKTtcblxuXG4gIGhhd3Rpb1BsdWdpbkxvYWRlci5hZGRNb2R1bGUoRGV2aWNlcy5wbHVnaW5OYW1lKTtcbn1cbiIsIi8vLyBDb3B5cmlnaHQgMjAxNC0yMDE1IFJlZCBIYXQsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzXG4vLy8gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQgYnkgdGhlIEBhdXRob3IgdGFncy5cbi8vL1xuLy8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy8vXG4vLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vL1xuLy8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiZXhhbXBsZVBsdWdpbi50c1wiLz5cbm1vZHVsZSBEZXZpY2VzIHtcblxuICBleHBvcnQgdmFyIFJvdXRlc0NvbnRyb2xsZXIgPSBfbW9kdWxlLmNvbnRyb2xsZXIoXCJEZXZpY2VzLlJvdXRlc0NvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgXCIkcm91dGVcIiwgKCRzY29wZSwgJGh0dHAsICRyb3V0ZSkgPT4ge1xuICAgICAgJGh0dHAuZ2V0KEdlb2ZlbmNpbmcuZGV2aWNlQ2xvdWRsZXRBcGlCYXNlKCkgKyAnL2RldmljZScpLlxuICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgJHNjb3BlLmRldmljZXMgPSBkYXRhLmRldmljZXM7XG4gICAgICAgICAgfSkuXG4gICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgJHNjb3BlLmZsYXNoID0gJ0Nhbm5vdCBjb25uZWN0IHRvIHRoZSBkZXZpY2Ugc2VydmljZS4nO1xuICAgICAgICAgIH0pO1xuXG4gICAgJHNjb3BlLmxvYWRSb3V0ZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJGh0dHAuZ2V0KEdlb2ZlbmNpbmcuZ2VvZmVuY2luZ0Nsb3VkbGV0QXBpQmFzZSgpICsgJy9yb3V0ZXMvcm91dGVzLycgKyAkc2NvcGUuc2VsZWN0ZWRPcHRpb24uaWQpLlxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICRzY29wZS5yb3V0ZXMgPSBkYXRhLnJvdXRlcy5tYXAoZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm91dGVUaW1lc3RhbXAgPSBuZXcgRGF0ZSh2YWwuY3JlYXRlZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSAocm91dGVUaW1lc3RhbXAuZ2V0TW9udGgoKSArIDEpICsgXCItXCIgKyByb3V0ZVRpbWVzdGFtcC5nZXREYXRlKCkgKyBcIi1cIiArIHJvdXRlVGltZXN0YW1wLmdldEZ1bGxZZWFyKCkgKyAnICcgKyByb3V0ZVRpbWVzdGFtcC5nZXRIb3VycygpICsgXCI6XCIgKyByb3V0ZVRpbWVzdGFtcC5nZXRNaW51dGVzKCkgKyBcIjpcIiArIHJvdXRlVGltZXN0YW1wLmdldFNlY29uZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRpbWVzdGFtcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB2YWwuaWRcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZihkYXRhLnJvdXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFJvdXRlID0gJHNjb3BlLnJvdXRlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlU2VsZWN0ZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZsYXNoID0gJ0Nhbm5vdCBjb25uZWN0IHRvIHRoZSBnZW9mZW5jaW5nIHNlcnZpY2UuJztcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuY2xpZW50U2VsZWN0ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5jbGllbnQgPSAkc2NvcGUuc2VsZWN0ZWRPcHRpb24uaWQ7XG4gICAgICAkc2NvcGUucm91dGVzRXhwb3J0TGluayA9IEdlb2ZlbmNpbmcuZ2VvZmVuY2luZ0Nsb3VkbGV0QXBpQmFzZSgpICsgJy9yb3V0ZXMvZXhwb3J0LycgKyAkc2NvcGUuY2xpZW50ICsgJy94bHMnO1xuICAgICAgJHNjb3BlLmxvYWRSb3V0ZXMoKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnJvdXRlU2VsZWN0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJGh0dHAuZ2V0KEdlb2ZlbmNpbmcuZ2VvZmVuY2luZ0Nsb3VkbGV0QXBpQmFzZSgpICsgJy9yb3V0ZXMvcm91dGVVcmwvJyArICRzY29wZS5zZWxlY3RlZFJvdXRlLmlkKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAkc2NvcGUucm91dGVVcmwgPSBkYXRhLnJvdXRlVXJsO1xuICAgICAgICAgICAgICAkc2NvcGUubG9hZFJvdXRlQ29tbWVudHMoKTtcbiAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgJHNjb3BlLmZsYXNoID0gJ0Nhbm5vdCBjb25uZWN0IHRvIHRoZSBnZW9mZW5jaW5nIHNlcnZpY2UuJztcbiAgICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJGh0dHAuZ2V0KEdlb2ZlbmNpbmcuZ2VvZmVuY2luZ0Nsb3VkbGV0QXBpQmFzZSgpICsgJy9yb3V0ZXMvY2xpZW50cycpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgJHNjb3BlLmNsaWVudHMgPSBkYXRhLmNsaWVudHMubWFwKGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIG5hbWU6IHZhbCxcbiAgICAgICAgICAgICAgaWQ6IHZhbFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZihkYXRhLmNsaWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkT3B0aW9uID0gJHNjb3BlLmNsaWVudHNbMF07XG4gICAgICAgICAgICAkc2NvcGUuY2xpZW50U2VsZWN0ZWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLlxuICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICRzY29wZS5mbGFzaCA9ICdDYW5ub3QgY29ubmVjdCB0byB0aGUgZ2VvZmVuY2luZyBzZXJ2aWNlLic7XG4gICAgICAgIH0pO1xuICAgICAgJHNjb3BlLmFkZENvbW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkaHR0cC5wb3N0KEdlb2ZlbmNpbmcuY2xvdWRsZXRBcGlCYXNlKCkgKyAnL2RvY3VtZW50L3NhdmUvUm91dGVDb21tZW50Jywge3JvdXRlSWQ6ICRzY29wZS5zZWxlY3RlZFJvdXRlLmlkLCB0ZXh0OiAkc2NvcGUubmV3Q29tbWVudCwgY3JlYXRlZDogbmV3IERhdGUoKS5nZXRUaW1lKCl9KS5cbiAgICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRSb3V0ZUNvbW1lbnRzKCk7XG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZmxhc2ggPSAnTmV3IGNvbW1lbnQgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIHJvdXRlLic7XG4gICAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgJHNjb3BlLmZsYXNoID0gJ1RoZXJlIHdhcyBwcm9ibGVtIHdpdGggYWRkaW5nIGNvbW1lbnQgdG8gdGhlIHJvdXRlLic7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgICRzY29wZS5sb2FkUm91dGVDb21tZW50cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRodHRwLnBvc3QoR2VvZmVuY2luZy5jbG91ZGxldEFwaUJhc2UoKSArICcvZG9jdW1lbnQvZmluZEJ5UXVlcnkvUm91dGVDb21tZW50Jywge3BhZ2U6IDAsIHNpemU6IDEwMCwgb3JkZXJCeTogWydjcmVhdGVkJ10sIHNvcnRBc2NlbmRpbmc6IC0xLCBxdWVyeToge3JvdXRlSWRJbjogWyRzY29wZS5zZWxlY3RlZFJvdXRlLmlkXX19KS5cbiAgICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlQ29tbWVudHMgPSBkYXRhO1xuICAgICAgICAgICAgICB9KS5cbiAgICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICRzY29wZS5mbGFzaCA9ICdUaGVyZSB3YXMgcHJvYmxlbSByZWFkaW5nIHJvdXRlIGNvbW1lbnRzLic7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgJHNjb3BlLmRlbGV0ZVJvdXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJGh0dHAuZGVsZXRlKEdlb2ZlbmNpbmcuZ2VvZmVuY2luZ0Nsb3VkbGV0QXBpQmFzZSgpICsgJy9yb3V0ZXMvZGVsZXRlLycgKyAkc2NvcGUuc2VsZWN0ZWRSb3V0ZS5pZCk7XG4gICAgICAgICAgJHJvdXRlLnJlbG9hZCgpO1xuICAgICAgfTtcbiAgfV0pO1xuXG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
angular.module("device-ui-templates", []).run(["$templateCache", function($templateCache) {$templateCache.put("plugins/example/html/devices.html","<!--\n Licensed to the Camel Labs under one or more\n contributor license agreements.  See the NOTICE file distributed with\n this work for additional information regarding copyright ownership.\n The licenses this file to You under the Apache License, Version 2.0\n (the \"License\"); you may not use this file except in compliance with\n the License.  You may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n-->\n<div class=\"row\">\n    <div class=\"col-md-12\" ng-controller=\"Devices.RoutesController\">\n        <p ng-show=\"flash\">{{flash}}</p>\n\n            <p>\n            <div ng-repeat=\"devices in devices\">\n                    {{device.endpoint}} <br/>\n            </div>\n            </p>\n\n        Show routes for <select ng-show=\"clients.length > 0\" data-ng-options=\"o.name for o in clients\"\n                data-ng-model=\"selectedOption\" ng-change=\"clientSelected()\"></select>\n\n        <p ng-show=\"clients.length == 0\">No clients in the database.</p>\n\n        <select ng-show=\"routes.length > 0\" ng-options=\"o.name for o in routes\"\n                data-ng-model=\"selectedRoute\" ng-change=\"routeSelected()\"></select>\n\n        <button class=\"btn\" ng-show=\"routes.length > 0\" ng-click=\"deleteRoute()\">\n            Delete route\n        </button>\n\n        <p ng-show=\"clients.length > 0\">\n            <a ng-href=\"{{routesExportLink}}\">Excel report for {{client}}</a>\n        </p>\n\n        <p ng-show=\"selectedRoute\">\n            <img ng-src=\"{{routeUrl}}\" />\n            <p>Route comments:</p>\n        <input type=\"text\" ng-model=\"newComment\"/>\n        <button class=\"btn\" ng-click=\"addComment()\">\n            New comment\n        </button>\n        <br>\n        <div ng-repeat=\"comment in routeComments\">\n            {{comment.text}} <br/>\n        </div>\n        </p>\n        <p ng-show=\"clients.length > 0 && routes.length == 0\">No routes for the given client.</p>\n    </div>\n</div>\n");}]); hawtioPluginLoader.addModule("device-ui-templates");